---
title: "Stat 464 HW 7"
author: "Nicholas Way"
date: "2024-03-02"
output: html_document
---

### Front Matter
```{r}
rm(list = ls())
library(ggplot2)
library(tidyverse)
library(BSDA)
library(haven)
```

I used chatgpt to help me write/give me ideas for some of the coding for the tests

# Question 1
## Part a
### permutation differences

Pair       1    2  3  4
Treatment1 110 240 56 83
Treatment2 100 245 50 80
Difference  10  -5  6  3

1.  Mean of [10, 5, 6, 3]: 6.0
2.  Mean of [10, 5, 6, -3]: 4.5
3.  Mean of [10, 5, -6, 3]: 3.0
4.  Mean of [10, 5, -6, -3]: 1.5
5.  Mean of [10, -5, 6, 3]: 3.5 observed
6.  Mean of [10, -5, 6, -3]: 2.0
7.  Mean of [10, -5, -6, 3]: 0.5
8.  Mean of [10, -5, -6, -3]: -1.0
9.  Mean of [-10, 5, 6, 3]: 1.0
10. Mean of [-10, 5, 6, -3]: -0.5
11. Mean of [-10, 5, -6, 3]: -2.0
12. Mean of [-10, 5, -6, -3]: -3.5
13. Mean of [-10, -5, 6, 3]: -1.5
14. Mean of [-10, -5, 6, -3]: -3.0
15. Mean of [-10, -5, -6, 3]: -4.5
16. Mean of [-10, -5, -6, -3]: -6.0

## Part b
### Is there significance

H0: T1 = T2      Ha: T1 > T2

n = 4

P value = #{D >= Dobs}/2^n = #{D >= 3.5}/16 = 3/16 = 0.1875 > .05, therefore we fail to reject the null hypothesis.

There is not significant evidence that Treatment 1 tends to be associated with greater values than Treatment 2.

## Part c
### Signed Rank

             4   2  3  1
1.  Rank of [10, 5, 6, 3]:      6.0, 10
2.  Rank of [10, 5, 6, -3]:     4.5, 9
3.  Rank of [10, 5, -6, 3]:     3.0, 7
4.  Rank of [10, 5, -6, -3]:    1.5, 6
5.  Rank of [10, -5, 6, 3]:     3.5, 8 observed
6.  Rank of [10, -5, 6, -3]:    2.0, 7
7.  Rank of [10, -5, -6, 3]:    0.5, 5
8.  Rank of [10, -5, -6, -3]:   1.0, 4
9.  Rank of [-10, 5, 6, 3]:    -1.0, 6
10. Rank of [-10, 5, 6, -3]:   -0.5, 5
11. Rank of [-10, 5, -6, 3]:   -2.0, 3
12. Rank of [-10, 5, -6, -3]:  -3.5, 2
13. Rank of [-10, -5, 6, 3]:   -1.5, 4
14. Rank of [-10, -5, 6, -3]:  -3.0, 3
15. Rank of [-10, -5, -6, 3]:  -4.5, 1
16. Rank of [-10, -5, -6, -3]: -6.0, 0

## Part d
### Is there significance

H0: T1 = T2      Ha: T1 > T2

n = 4

P value = #{SR+ >= SR+obs}/2^n = #{SR+ >= 8}/16 = 3/16 = 0.1875 > .05, therefore we fail to reject the null hypothesis.

There is not significant evidence that Treatment 1 tends to be associated with greater values than Treatment 2.

# Question 2
## Part a
### Is there significance

xbar walking = 18.9    xbar hypnotic = 21.7

(18 - 18.9)^2 = 0.81   (25 - 21.7)^2 = 10.89
(19 - 18.9)^2 = 0.01   (20 - 21.7)^2 = 2.89
(16 - 18.9)^2 = 8.41   (26 - 21.7)^2 = 18.49
(21 - 18.9)^2 = 4.41   (26 - 21.7)^2 = 18.49
(16 - 18.9)^2 = 8.41   (20 - 21.7)^2 = 2.89
(20 - 18.9)^2 = 1.21   (23 - 21.7)^2 = 1.69
(20 - 18.9)^2 = 1.21   (14 - 21.7)^2 = 59.29
(14 - 18.9)^2 = 24.01  (18 - 21.7)^2 = 13.69
(11 - 18.9)^2 = 62.41  (18 - 21.7)^2 = 13.69
(22 - 18.9)^2 = 9.61   (20 - 21.7)^2 = 2.89
(19 - 18.9)^2 = .01    (22 - 21.7)^2 = 0.09
(29 - 18.9)^2 = 102.01 (27 - 21.7)^2 = 28.09
(16 - 18.9)^2 = 8.41   (19 - 21.7)^2 = 7.29
(27 - 18.9)^2 = 65.61  (27 - 21.7)^2 = 28.09
(15 - 18.9)^2 = 15.21  (21 - 21.7)^2 = 0.49

SSW = Sum of these differences = 520.7

SSB = 15(18.9 - 21.7)^2 = 117.6

MSW = SSW/(N-k) = 520.7/(30-2) = 18.5964285714

MSB = SSB/(k-1) = 117.6/(2-1) = 117.6

F = MSB/MSW = 117.6/18.5964285714 = 6.3237948915

The p-value is .017935 which is < .05, therefore we reject the null hypothesis

## Part b
### Sign Test

H0: T1 = T2     Ha: T1 < T2

Count pairs where Walking is less than Hypnotic

W > H = 3
W < H = 11
W = H = 1

Binomial distribution p value = 0.029 < .05, therefpre we reject the null hypothesis 

Normal Approximation: n = 15, p =.5

mu = np = 7.5
sd = (np(1-p))^.5 = 3.75^.5 = 1.9364916731
z = (n-)-.5-mu/sd = 11-8/1.9364916731 = 3/1.9364916731 = 1.54919333849

p value = .060679 > .05, so we fail to reject the null hypothesis.

The normal approximation method results in us not rejecting the null hypothesis while the non normal approximation method results in us rejecting the null hypothesis.

# Question 3
### Is there significance

H0: A = B     Ha: A < B

Count pairs where Walking is less than Hypnotic

A > B = 19
A < B = ?
A = B = ?

Normal Approximation / Large Sample: n = 28, p =.5

mu = np = 14
sd = (np(1-p))^.5 = 7^.5 = 2.64575131106
z = (n+)-.5-mu/sd = 4.5/2.64575131106 = 1.70084012854

p value = .04449. < .05, so we reject the null hypothesis.

# Question 4
### Is there significance

H0: x = y     Ha: x not equal y
                      
                      Rank

1  EF 4.67 4.36 0.31  7
2  LC 3.50 3.64 0.14  -3
3  AM 3.50 4.00 0.50  -11
4  CH 3.88 3.26 0.62  12
5  DW 3.94 4.06 0.12  -2
6  CA 4.88 4.58 0.30  6
7  MP 4.00 3.52 0.48  10
8  CP 4.40 3.66 0.74  13
9  RR 4.41 4.43 0.02  -1
10 TB 4.11 4.28 0.17  -4
11 GS 3.45 4.25 0.80  -15
12 HT 4.29 4.00 0.29  5
13 DW 4.25 5.00 0.75  -14
14 FE 4.18 3.85 0.33  8
15 WD 4.65 4.18 0.47  9

x > y = 8, Sum of positive ranks = 70 = R+
x < y = 7, Sum of positive ranks = 50 = R-
x = y = 0

z = (R+ - muR)/sdR or (R- - muR)/sdR

muR = (n(n+1))/4 = 60
sdR = (n(n+1)(2n+1)/24)^.5 = 17.6068168617

Z = (70 - 60)/17.6068168617 = 0.56796183424, p value = .570103 > .05, therefore we fail to reject the null hypothesis

Z = (50 - 60)/17.6068168617 = -0.56796183424, p value = .570103 > .05, therefore we fail to reject the null hypothesis

# Question 5
### Is there significance

H0: x = y     Ha: x not equal y
                      
         Rank

1  -6   -4.5
2  10    10.5
3  9     8
4  -9   -8
5  -6   -4.5
6  -2   -1.5
7  20    12
9  -7   -6
10 5     3
11 -9   -8
12 -10  -10.5
13 -2   -1.5

x > y = 4, Sum of positive ranks = 33.5 = R+
x < y = 8, Sum of positive ranks = 44.5 = R-
x = y = 1, excluded

z = (R+ - muR)/sdR or (R- - muR)/sdR

muR = (n(n+1))/4 = 39
sdR = (n(n+1)(2n+1)/24)^.5 = 12.747548784

Z = (33.5 - 39)/12.747548784 = -0.4314554973, p value = .666178 > .05, therefore we fail to reject the null hypothesis

Z = (44.5 - 39)/12.747548784 = 0.4314554973, p value = .666178 > .05, therefore we fail to reject the null hypothesis

# Question 6
## Part a
### Is there significance

```{r}
# Data for Treatment 1 and Treatment 2
treatment_1 <- c(5, 3, 14, 17, 2, 11, 2)
treatment_2 <- c(18, 5, 25, 20, 1, 19, 3)

# Perform Wilcoxon signed-rank test
test_result <- wilcox.test(treatment_1, treatment_2, paired = TRUE)

test_result
```

The p value is .04215 < .05, therefore we reject the null hypothesis that Treatment 1 and Treatment 2 tend to be equal. There is evidence that Treatment 1 tends to be associated with smaller values than Treatment 2.

## Part b
### Can you use Wilcoxon Rank-Sum Test

The Wilcoxon Rank-Sum Test is not applicable to the above data because it is designed for comparing two independent samples, whereas the data provided involves paired samples. The correct approach for paired samples, as we have used, is the Wilcoxon Signed-Rank Test.

The relationship between these tests and others like the t-test and paired t-test is that the Wilcoxon Rank-Sum Test is a non-parametric alternative to the independent samples t-test and is used when the assumptions of the t-test are not met for comparing two independent samples.

The Wilcoxon Signed-Rank Test is a non-parametric alternative to the paired samples t-test, suitable for paired or matched data when the distribution of differences does not meet the assumptions of normality.

The t-test (independent samples) compares the means of two independent groups to determine if there is statistical evidence that the associated population means are significantly different.

The paired t-test compares the means of two related groups to determine if there is a significant difference between these means.

# Question 7
### Which Procedure

Given the additional information utilized by the signed-rank test (magnitude of differences, in addition to their direction), you would generally expect the signed-rank test to have greater power compared to the sign test when testing the (H0: Median = H) in a symmetric population. This increased power comes from its ability to detect not just whether differences exist but how significant these differences are in terms of their magnitude, allowing for a more sensitive analysis of the data.

The reason for the greater power of the signed-rank test lies in its use of rank information. By ranking the differences, the signed-rank test can more effectively discriminate between minor and major deviations from the null hypothesis, making it more likely to detect a true effect when one exists. In contrast, the sign test, by ignoring the magnitude of changes and focusing solely on their direction, may miss subtle but consistent differences between pairs.


